#!/usr/bin/env python3
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è OAuth —Ç–æ–∫–µ–Ω–∞ –Ø–Ω–¥–µ–∫—Å –î–∏—Å–∫–∞
"""
import os
import webbrowser
from dotenv import load_dotenv

# –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
load_dotenv()

CLIENT_ID = os.getenv("YANDEX_DISK_CLIENT_ID", "047b883acf9042e2a85f901255b81520")

def get_oauth_url():
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç URL –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è OAuth —Ç–æ–∫–µ–Ω–∞"""
    # URL –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä
    # response_type=token –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Ç–æ–∫–µ–Ω –≤–µ—Ä–Ω–µ—Ç—Å—è –≤ URL –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
    url = f"https://oauth.yandex.ru/authorize?response_type=token&client_id={CLIENT_ID}"
    return url

def main():
    print("=" * 80)
    print("üîê –ü–æ–ª—É—á–µ–Ω–∏–µ OAuth —Ç–æ–∫–µ–Ω–∞ –¥–ª—è –Ø–Ω–¥–µ–∫—Å –î–∏—Å–∫–∞")
    print("=" * 80)
    print()
    print(f"Client ID: {CLIENT_ID}")
    print()
    print("üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:")
    print("1. –û—Ç–∫—Ä–æ–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä —Å —Ñ–æ—Ä–º–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ø–Ω–¥–µ–∫—Å")
    print("2. –í–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç –Ø–Ω–¥–µ–∫—Å (–µ—Å–ª–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã)")
    print("3. –ù–∞–∂–º–∏—Ç–µ '–†–∞–∑—Ä–µ—à–∏—Ç—å' –¥–ª—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞")
    print("4. –ü–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤—ã –±—É–¥–µ—Ç–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å —Ç–æ–∫–µ–Ω–æ–º")
    print("5. –¢–æ–∫–µ–Ω –±—É–¥–µ—Ç –≤ URL –ø–æ—Å–ª–µ 'access_token='")
    print("6. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω (–¥–æ —Å–∏–º–≤–æ–ª–∞ '&' –∏–ª–∏ –¥–æ –∫–æ–Ω—Ü–∞)")
    print("7. –û–±–Ω–æ–≤–∏—Ç–µ —Ñ–∞–π–ª .env —Å –Ω–æ–≤—ã–º —Ç–æ–∫–µ–Ω–æ–º")
    print()
    print("‚ö†Ô∏è  –í–ê–ñ–ù–û: –¢–æ–∫–µ–Ω –±—É–¥–µ—Ç –≤–∏–¥–µ–Ω –≤ URL –±—Ä–∞—É–∑–µ—Ä–∞!")
    print("   –ù–µ –¥–µ–ª–∏—Ç–µ—Å—å —ç—Ç–∏–º URL —Å –¥—Ä—É–≥–∏–º–∏ –ª—é–¥—å–º–∏.")
    print()
    
    url = get_oauth_url()
    print(f"üîó URL –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:")
    print(f"   {url}")
    print()
    
    response = input("–û—Ç–∫—Ä—ã—Ç—å –±—Ä–∞—É–∑–µ—Ä –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏? (y/n): ").strip().lower()
    if response == 'y' or response == 'yes' or response == '':
        print("\nüåê –û—Ç–∫—Ä—ã–≤–∞—é –±—Ä–∞—É–∑–µ—Ä...")
        webbrowser.open(url)
        print("\n‚úÖ –ë—Ä–∞—É–∑–µ—Ä –æ—Ç–∫—Ä—ã—Ç. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω –∏–∑ URL.")
        print("\nüí° –ü—Ä–∏–º–µ—Ä URL —Å —Ç–æ–∫–µ–Ω–æ–º:")
        print("   https://oauth.yandex.ru/verification_code#access_token=–í–ê–®_–¢–û–ö–ï–ù&token_type=bearer")
        print("\n   –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —á–∞—Å—Ç—å –ø–æ—Å–ª–µ 'access_token=' –∏ –¥–æ '&' (–∏–ª–∏ –¥–æ –∫–æ–Ω—Ü–∞)")
    else:
        print(f"\nüìã –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:")
        print(f"   {url}")
    
    print("\n" + "=" * 80)
    print("–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞:")
    print("1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª .env")
    print("2. –û–±–Ω–æ–≤–∏—Ç–µ YANDEX_DISK_OAUTH_TOKEN –Ω–æ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º")
    print("3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª")
    print("4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ list_yandex_disk.py —Å–Ω–æ–≤–∞")
    print("=" * 80)

if __name__ == "__main__":
    main()


